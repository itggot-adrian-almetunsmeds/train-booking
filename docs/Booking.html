<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Booking
  
    &mdash; Documentation by YARD 0.9.20
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Booking";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (B)</a> &raquo;
    
    
    <span class="title">Booking</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Booking
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="DBHandler.html" title="DBHandler (class)">DBHandler</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="DBHandler.html" title="DBHandler (class)">DBHandler</a></span></li>
          
            <li class="next">Booking</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>modules/booking.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Handles all bookings</p>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#arrival_location-instance_method" title="#arrival_location (instance method)">#<strong>arrival_location</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute arrival_location.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#arrival_platform-instance_method" title="#arrival_platform (instance method)">#<strong>arrival_platform</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute arrival_platform.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#arrival_time-instance_method" title="#arrival_time (instance method)">#<strong>arrival_time</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute arrival_time.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#booking_id-instance_method" title="#booking_id (instance method)">#<strong>booking_id</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute booking_id.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#departure_location-instance_method" title="#departure_location (instance method)">#<strong>departure_location</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute departure_location.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#departure_platform-instance_method" title="#departure_platform (instance method)">#<strong>departure_platform</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute departure_platform.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#departure_time-instance_method" title="#departure_time (instance method)">#<strong>departure_time</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute departure_time.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#id-instance_method" title="#id (instance method)">#<strong>id</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute id.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#session_id-instance_method" title="#session_id (instance method)">#<strong>session_id</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute session_id.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#status-instance_method" title="#status (instance method)">#<strong>status</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute status.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#ticket_name-instance_method" title="#ticket_name (instance method)">#<strong>ticket_name</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute ticket_name.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#tickets-instance_method" title="#tickets (instance method)">#<strong>tickets</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute tickets.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#total_points-instance_method" title="#total_points (instance method)">#<strong>total_points</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute total_points.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#total_price-instance_method" title="#total_price (instance method)">#<strong>total_price</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute total_price.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#user_id-instance_method" title="#user_id (instance method)">#<strong>user_id</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute user_id.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create-class_method" title="create (class method)">.<strong>create</strong>(payload, session, back)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>rubocop:disable Metrics/MethodLength.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#confirm-instance_method" title="#confirm (instance method)">#<strong>confirm</strong>(booking, user_id = nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>rubocop:enable Metrics/MethodLength.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(id)  &#x21d2; Booking </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>rubocop:disable Metrics/MethodLength.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="DBHandler.html" title="DBHandler (class)">DBHandler</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="DBHandler.html#all-class_method" title="DBHandler.all (method)">all</a></span>, <span class='object_link'><a href="DBHandler.html#connect-class_method" title="DBHandler.connect (method)">connect</a></span>, <span class='object_link'><a href="DBHandler.html#execute-class_method" title="DBHandler.execute (method)">execute</a></span>, <span class='object_link'><a href="DBHandler.html#last-class_method" title="DBHandler.last (method)">last</a></span>, <span class='object_link'><a href="DBHandler.html#save-instance_method" title="DBHandler#save (method)">#save</a></span>, <span class='object_link'><a href="DBHandler.html#with_condition-class_method" title="DBHandler.with_condition (method)">with_condition</a></span>, <span class='object_link'><a href="DBHandler.html#with_id-class_method" title="DBHandler.with_id (method)">with_id</a></span>, <span class='object_link'><a href="DBHandler.html#write_to_db-class_method" title="DBHandler.write_to_db (method)">write_to_db</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(id)  &#x21d2; <tt><span class='object_link'><a href="" title="Booking (class)">Booking</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>rubocop:disable Metrics/MethodLength</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'modules/booking.rb', line 16</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span> <span class='comment'># rubocop:disable Metrics/AbcSize
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>String</span>
    <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="DBHandler.html" title="DBHandler (class)">DBHandler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_execute'><span class='object_link'><a href="DBHandler.html#execute-class_method" title="DBHandler.execute (method)">execute</a></span></span><span class='lparen'>(</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SELECT bookings.id, bookings.status, bookings.session_id, bookings.id, user_id,</span><span class='tstring_end'>&#39;</span></span> \
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> departure.name AS departure_location, arrival.name AS arrival_location,</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> dep.name AS departure_platform, arr.name AS arrival_platform, tickets.name AS ticket_name,</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> arrival_time, departure_time, points, amount, tickets.id AS ticket_id,</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> bookings.price as booking_price, bookings.service_id</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> FROM bookings</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> LEFT JOIN booking_connector</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> ON bookings.id = booking_connector.booking_id</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> LEFT JOIN tickets</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> ON booking_connector.ticket_id = tickets.id</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> LEFT JOIN services</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> ON bookings.service_id = services.id</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> LEFT JOIN platforms AS dep</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> ON services.departure_id = dep.id</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> LEFT JOIN platforms AS arr</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> ON services.arrival_id = arr.id</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> LEFT JOIN destinations as arrival</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> ON arr.destination_id = arrival.id</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> LEFT JOIN destinations as departure</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> ON dep.destination_id = departure.id</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> WHERE session_id = ?</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span>
    <span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="DBHandler.html" title="DBHandler (class)">DBHandler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_execute'><span class='object_link'><a href="DBHandler.html#execute-class_method" title="DBHandler.execute (method)">execute</a></span></span><span class='lparen'>(</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SELECT bookings.id, bookings.status, bookings.session_id, bookings.id, user_id,</span><span class='tstring_end'>&#39;</span></span> \
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> departure.name AS departure_location, arrival.name AS arrival_location,</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> dep.name AS departure_platform, arr.name AS arrival_platform, tickets.name AS ticket_name,</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> arrival_time, departure_time, points, amount, tickets.id AS ticket_id,</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> bookings.price as booking_price, bookings.service_id</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> FROM bookings</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> LEFT JOIN booking_connector</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> ON bookings.id = booking_connector.booking_id</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> LEFT JOIN tickets</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> ON booking_connector.ticket_id = tickets.id</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> LEFT JOIN services</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> ON bookings.service_id = services.id</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> LEFT JOIN platforms AS dep</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> ON services.departure_id = dep.id</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> LEFT JOIN platforms AS arr</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> ON services.arrival_id = arr.id</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> LEFT JOIN destinations as arrival</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> ON arr.destination_id = arrival.id</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> LEFT JOIN destinations as departure</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> ON dep.destination_id = departure.id</span><span class='tstring_end'>&#39;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> WHERE bookings.id = ?</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span>
    <span class='rparen'>)</span>
<span class='kw'>end</span>
  <span class='ivar'>@tickets</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@total_points</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_z'>z</span><span class='op'>|</span>
    <span class='id identifier rubyid_ticket'>ticket</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Ticket.html" title="Ticket (class)">Ticket</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Ticket.html#initialize-instance_method" title="Ticket#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_z'>z</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ticket_id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_z'>z</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>amount</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_seat'>seat</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Seat.html" title="Seat (class)">Seat</a></span></span><span class='period'>.</span><span class='id identifier rubyid_booked_seat'><span class='object_link'><a href="Seat.html#booked_seat-class_method" title="Seat.booked_seat (method)">booked_seat</a></span></span> <span class='id identifier rubyid_z'>z</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_z'>z</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>service_id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_ticket'>ticket</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Objects.html" title="Objects (class)">Objects</a></span></span><span class='period'>.</span><span class='id identifier rubyid_merge'><span class='object_link'><a href="Objects.html#merge-class_method" title="Objects.merge (method)">merge</a></span></span><span class='lparen'>(</span> <span class='id identifier rubyid_seat'>seat</span><span class='comma'>,</span> <span class='id identifier rubyid_ticket'>ticket</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_ticket'>ticket</span><span class='period'>.</span><span class='id identifier rubyid_instance_variables'>instance_variables</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='symbol'>:attr_reader</span><span class='comma'>,</span> <span class='id identifier rubyid_k'>k</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='lbracket'>[</span><span class='int'>1</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span><span class='rparen'>)</span><span class='rbrace'>}</span>
<span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_ticket'>ticket</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span>
    <span class='id identifier rubyid_tickets'>tickets</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_ticket'>ticket</span>
    <span class='ivar'>@total_points</span> <span class='op'>+=</span> <span class='id identifier rubyid_ticket'>ticket</span><span class='period'>.</span><span class='id identifier rubyid_total_points'>total_points</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='ivar'>@total_price</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>booking_price</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='ivar'>@id</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='ivar'>@session_id</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>session_id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='ivar'>@status</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='ivar'>@booking_id</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='ivar'>@user_id</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user_id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='ivar'>@departure_location</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>departure_location</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='ivar'>@departure_platform</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>departure_platform</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='ivar'>@arrival_location</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>arrival_location</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='ivar'>@arrival_platform</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>arrival_platform</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='ivar'>@departure_time</span> <span class='op'>=</span> <span class='const'>DateTime</span><span class='period'>.</span><span class='id identifier rubyid_strptime'>strptime</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>departure_time</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%s</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='ivar'>@arrival_time</span> <span class='op'>=</span> <span class='const'>DateTime</span><span class='period'>.</span><span class='id identifier rubyid_strptime'>strptime</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>arrival_time</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%s</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="arrival_location-instance_method">
  
    #<strong>arrival_location</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute arrival_location</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'modules/booking.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_arrival_location'>arrival_location</span>
  <span class='ivar'>@arrival_location</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="arrival_platform-instance_method">
  
    #<strong>arrival_platform</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute arrival_platform</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'modules/booking.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_arrival_platform'>arrival_platform</span>
  <span class='ivar'>@arrival_platform</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="arrival_time-instance_method">
  
    #<strong>arrival_time</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute arrival_time</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'modules/booking.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_arrival_time'>arrival_time</span>
  <span class='ivar'>@arrival_time</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="booking_id-instance_method">
  
    #<strong>booking_id</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute booking_id</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'modules/booking.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_booking_id'>booking_id</span>
  <span class='ivar'>@booking_id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="departure_location-instance_method">
  
    #<strong>departure_location</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute departure_location</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'modules/booking.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_departure_location'>departure_location</span>
  <span class='ivar'>@departure_location</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="departure_platform-instance_method">
  
    #<strong>departure_platform</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute departure_platform</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'modules/booking.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_departure_platform'>departure_platform</span>
  <span class='ivar'>@departure_platform</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="departure_time-instance_method">
  
    #<strong>departure_time</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute departure_time</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'modules/booking.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_departure_time'>departure_time</span>
  <span class='ivar'>@departure_time</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="id-instance_method">
  
    #<strong>id</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute id</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'modules/booking.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_id'>id</span>
  <span class='ivar'>@id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="session_id=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="session_id-instance_method">
  
    #<strong>session_id</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute session_id</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'modules/booking.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_session_id'>session_id</span>
  <span class='ivar'>@session_id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="status=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="status-instance_method">
  
    #<strong>status</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute status</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'modules/booking.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_status'>status</span>
  <span class='ivar'>@status</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="ticket_name-instance_method">
  
    #<strong>ticket_name</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute ticket_name</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'modules/booking.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ticket_name'>ticket_name</span>
  <span class='ivar'>@ticket_name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="tickets-instance_method">
  
    #<strong>tickets</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute tickets</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'modules/booking.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_tickets'>tickets</span>
  <span class='ivar'>@tickets</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="total_points-instance_method">
  
    #<strong>total_points</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute total_points</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'modules/booking.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_total_points'>total_points</span>
  <span class='ivar'>@total_points</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="total_price=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="total_price-instance_method">
  
    #<strong>total_price</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute total_price</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'modules/booking.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_total_price'>total_price</span>
  <span class='ivar'>@total_price</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="user_id=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="user_id-instance_method">
  
    #<strong>user_id</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute user_id</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'modules/booking.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_user_id'>user_id</span>
  <span class='ivar'>@user_id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="create-class_method">
  
    .<strong>create</strong>(payload, session, back)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>rubocop:disable Metrics/MethodLength</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'modules/booking.rb', line 110</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_payload'>payload</span><span class='comma'>,</span> <span class='id identifier rubyid_session'>session</span><span class='comma'>,</span> <span class='id identifier rubyid_back'>back</span><span class='rparen'>)</span> <span class='comment'># rubocop:disable Metrics/AbcSize
</span>  <span class='id identifier rubyid_payload'>payload</span> <span class='op'>=</span> <span class='const'>JSON</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_payload'>payload</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>value</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_payload'>payload</span> <span class='op'>=</span> <span class='const'>JSON</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_payload'>payload</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_tickets'>tickets</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_payload'>payload</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ticket'>ticket</span><span class='op'>|</span>
    <span class='id identifier rubyid_tickets'>tickets</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_ticket'>ticket</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_query'>query</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> tickets.id = ? OR</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='id identifier rubyid_query'>query</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>..</span><span class='op'>-</span><span class='int'>4</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_service'>service</span> <span class='op'>=</span> <span class='id identifier rubyid_back'>back</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_price'>price</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="DBHandler.html" title="DBHandler (class)">DBHandler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_execute'><span class='object_link'><a href="DBHandler.html#execute-class_method" title="DBHandler.execute (method)">execute</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT price, id from tickets WHERE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_query'>query</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
                            <span class='id identifier rubyid_tickets'>tickets</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_price_sum'>price_sum</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_payload'>payload</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ticket'>ticket</span><span class='op'>|</span>
    <span class='id identifier rubyid_price'>price</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_entity'>entity</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_ticket'>ticket</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>==</span> <span class='id identifier rubyid_entity'>entity</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
        <span class='id identifier rubyid_price_sum'>price_sum</span> <span class='op'>+=</span> <span class='id identifier rubyid_entity'>entity</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>price</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>*</span> <span class='id identifier rubyid_ticket'>ticket</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>amount</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Prevents there from being multiple unconfirmed tickets from the same session preventing accidental
</span>  <span class='comment'># dubble booking
</span>  <span class='const'><span class='object_link'><a href="DBHandler.html" title="DBHandler (class)">DBHandler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_execute'><span class='object_link'><a href="DBHandler.html#execute-class_method" title="DBHandler.execute (method)">execute</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DELETE FROM bookings WHERE session_id = ?</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_session'>session</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:user_id</span><span class='rbracket'>]</span>
    <span class='const'><span class='object_link'><a href="DBHandler.html" title="DBHandler (class)">DBHandler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_execute'><span class='object_link'><a href="DBHandler.html#execute-class_method" title="DBHandler.execute (method)">execute</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>INSERT INTO bookings (price, user_id, service_id, booking_time, status, </span><span class='tstring_end'>&#39;</span></span> \
              <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>session_id) VALUES (?,?,?,?,?,?)</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_price_sum'>price_sum</span><span class='comma'>,</span> <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:user_id</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_service'>service</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='comma'>,</span>
                      <span class='const'>DateTime</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_session'>session</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='const'><span class='object_link'><a href="DBHandler.html" title="DBHandler (class)">DBHandler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_execute'><span class='object_link'><a href="DBHandler.html#execute-class_method" title="DBHandler.execute (method)">execute</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>INSERT INTO bookings (price, service_id, booking_time, status, session_id) </span><span class='tstring_end'>&#39;</span></span>\
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VALUES (?,?,?,?,?)</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_price_sum'>price_sum</span><span class='comma'>,</span> <span class='id identifier rubyid_service'>service</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='comma'>,</span> <span class='const'>DateTime</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_session'>session</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_booking'>booking</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="DBHandler.html" title="DBHandler (class)">DBHandler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_last'><span class='object_link'><a href="DBHandler.html#last-class_method" title="DBHandler.last (method)">last</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>bookings</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='id identifier rubyid_payload'>payload</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ticket'>ticket</span><span class='op'>|</span>
    <span class='const'><span class='object_link'><a href="Seat.html" title="Seat (class)">Seat</a></span></span><span class='period'>.</span><span class='id identifier rubyid_reserve'><span class='object_link'><a href="Seat.html#reserve-class_method" title="Seat.reserve (method)">reserve</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_ticket'>ticket</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>amount</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='comma'>,</span> <span class='id identifier rubyid_service'>service</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='comma'>,</span> <span class='id identifier rubyid_booking'>booking</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='const'><span class='object_link'><a href="DBHandler.html" title="DBHandler (class)">DBHandler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_execute'><span class='object_link'><a href="DBHandler.html#execute-class_method" title="DBHandler.execute (method)">execute</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>INSERT INTO booking_connector (booking_id, ticket_id, amount) </span><span class='tstring_end'>&#39;</span></span>\
            <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>VALUES (?,?, ?)</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_booking'>booking</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ticket'>ticket</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_ticket'>ticket</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>amount</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="confirm-instance_method">
  
    #<strong>confirm</strong>(booking, user_id = nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>rubocop:enable Metrics/MethodLength</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


94
95
96
97
98
99
100
101
102
103
104
105
106
107</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'modules/booking.rb', line 94</span>

<span class='kw'>def</span> <span class='id identifier rubyid_confirm'>confirm</span><span class='lparen'>(</span><span class='id identifier rubyid_booking'>booking</span><span class='comma'>,</span> <span class='id identifier rubyid_user_id'>user_id</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span> <span class='comment'># rubocop:disable Metrics/MethodLength
</span>  <span class='id identifier rubyid_booking'>booking</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='int'>1</span>
  <span class='id identifier rubyid_booking'>booking</span><span class='period'>.</span><span class='id identifier rubyid_session_id'>session_id</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_user_id'>user_id</span>
    <span class='id identifier rubyid_booking'>booking</span><span class='period'>.</span><span class='id identifier rubyid_user_id'>user_id</span> <span class='op'>=</span> <span class='id identifier rubyid_user_id'>user_id</span>
    <span class='id identifier rubyid_user'>user</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="User.html" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="User.html#initialize-instance_method" title="User#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_points'>points</span> <span class='op'>+=</span> <span class='id identifier rubyid_total_points'>total_points</span>
    <span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>users</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_booking'>booking</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>bookings</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>params:</span> <span class='lbracket'>[</span><span class='lbrace'>{</span> <span class='label'>key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>value:</span> <span class='id identifier rubyid_booking'>booking</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span> <span class='rbrace'>}</span><span class='comma'>,</span>
                                    <span class='lbrace'>{</span> <span class='label'>key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>session_id</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>value:</span> <span class='id identifier rubyid_booking'>booking</span><span class='period'>.</span><span class='id identifier rubyid_session_id'>session_id</span> <span class='rbrace'>}</span><span class='comma'>,</span>
                                    <span class='lbrace'>{</span> <span class='label'>key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user_id</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>value:</span> <span class='id identifier rubyid_booking'>booking</span><span class='period'>.</span><span class='id identifier rubyid_user_id'>user_id</span> <span class='rbrace'>}</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>id:</span> <span class='id identifier rubyid_booking'>booking</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
  <span class='id identifier rubyid_booking'>booking</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Fri Dec  6 23:02:55 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.20 (ruby-2.6.3).
</div>

    </div>
  </body>
</html>